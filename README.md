# Router Bot для OpenWRT

## Описание
Router Bot - это скрипт на Lua для управления роутером на OpenWRT с сервисом Podkop. Бот позволяет выполнять различные команды для управления роутером, VPN-соединением, а также конфигурациями VLESS и списками доменов.

## Функциональные возможности
- Перезагрузка роутера
- Включение ПК по Wake-on-LAN
- Перезапуск сетевого сервиса
- Управление VPN (включение/выключение)
- Менеджер VLESS конфигураций
- Менеджер списков доменов
- Проверка скорости интернета

## Структура проекта
```
router_bot/
├── main.lua           # Основной файл бота
├── config.lua         # Глобальные настройки бота (требуется создать)
├── modules/
│   ├── system.lua     # Модуль для перезагрузки роутера и сети (требуется создать)
│   ├── vpn.lua        # Модуль управления VPN (требуется создать)
│   ├── wake_pc.lua    # Модуль включения ПК через WOL (требуется создать)
│   ├── send_message.lua # Модуль отправки сообщений (требуется создать)
│   ├── speed_test.lua # Модуль проверки скорости интернета (требуется создать)
│   └── config_manager/ # Директория для управления конфигурациями
│       ├── vless.lua  # Управление VPN конфигами (требуется создать)
│       └── domains.lua # Управление списками доменов (требуется создать)
└── data/
    ├── vpn_configs.json  # Хранение VPN конфигураций (требуется создать)
    └── domain_lists.json # Хранение списков доменов (требуется создать)
```

## Установка на OpenWRT
1. Создайте директории на роутере:
   ```
   mkdir -p /etc/router_bot/modules/config_manager /etc/router_bot/data
   ```

2. Загрузите файлы на роутер, например через SCP:
   ```
   scp -r * root@your_router_ip:/etc/router_bot/
   ```

3. Настройте права доступа:
   ```
   chmod +x /etc/router_bot/main.lua
   ```

## Использование
Запустите скрипт:
```
lua /etc/router_bot/main.lua
```

### Доступные команды
- `reboot` - перезагрузка роутера
- `restart_network` - перезапуск сети
- `wake_pc` - включить ПК
- `vpn_start` - запустить VPN
- `vpn_stop` - остановить VPN
- `vpn_status` - статус VPN
- `speed_test` - проверить скорость интернета
- `get_vless` - получить текущий VLESS конфиг
- `save_vless <name> <config>` - сохранить VLESS конфиг
- `activate_vless <name> <config>` - активировать VLESS конфиг
- `get_domains` - получить список доменов
- `add_domain <domain>` - добавить домен
- `remove_domain <domain>` - удалить домен
- `help` - список всех команд

## Интеграция с Telegram Mini App

В будущих версиях планируется интеграция с Telegram Mini App для более удобного управления роутером через графический интерфейс.

## Примечания
- Для функции Wake-on-LAN требуется установленный пакет `etherwake`
- Для проверки скорости требуется установленный пакет `speedtest-cli`
- Для работы с JSON требуется модуль `nixio.json` (обычно доступен в OpenWRT)
